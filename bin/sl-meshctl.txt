usage: %MAIN% [options] [command ...]

Run-time control of the Strongloop process manager.

Options:
  -h,--help               Print help and exit.
  -v,--version            Print version and exit.
  -C,--control CTL        Control endpoint for process manager.

The control endpoint for the process manager is searched for if not specified,
in this order:

1. `STRONGLOOP_PM` in environment: may be a local domain path, or an HTTP URL.
2. `./pmctl`: a process manager running in the current working directory.
3. `~/.strong-pm/pmctl`: a process manager running in the user's home directory.
4. `/var/lib/strong-pm/pmctl`: a process manager installed by pm-install.
5. `http://localhost:8701`: a process manager running on localhost

An HTTP URL is mandatory for remote process managers, but can also be used on
localhost. If the process manager is using HTTP authentication
then valid credentials must be set in the URL directly, such as
`http://user-here:pass-here@example.com:7654`.

When using an HTTP URL, it can optionally be tunneled over ssh by changing the
protocol to `http+ssh://`. The ssh username will default to your current user
and authentication defaults to using your current ssh-agent. The username can be
overridden by setting an `SSH_USER` environment variable. The authentication can
be overridden to use an existing private key instead of an agent by setting the
`SSH_KEY` environment variable to the path of the private key to be used.

Commands:
  status [SRV_ID]         Report status for Service SRV_ID, or all services if
        no SRV_ID is provided. This is the default command.
  shutdown                Stop the process manager.
  start SRV_ID            Start service SRV_ID.
  stop SRV_ID             Hard stop service SRV_ID.
  soft-stop SRV_ID        Soft stop service SRV_ID.
  restart SRV_ID          Hard stop and restart service SRV_ID with new config.
  soft-restart SRV_ID     Soft stop and restart service SRV_ID with new config.
        "Soft" stops notify workers they are being disconnected, and give them
        a grace period for any existing connections to finish. "Hard" stops
        kill the supervisor and its workers with `SIGTERM`.

  cluster-restart SRV_ID  Restart the service SRV_ID cluster workers.
        This is a zero-downtime restart, the workers are soft restarted
        one-by-one, so that some workers will always be available to service
        requests.

  set-size SRV_ID N       Set cluster size for service SRV_ID to N workers.
        The default cluster size is the number of CPU cores.

  objects-start ID        Start tracking objects on worker ID.
  objects-stop ID         Stop tracking objects on worker ID.
        Object tracking is published as metrics, and requires configuration so
        that the `--metrics=URL` option is passed to the runner.

  cpu-start ID [TIMEOUT]  Start CPU profiling on worker ID.
        TIMEOUT is the optional watchdog timeout, in milliseconds.  In watchdog
        mode, the profiler is suspended until an event loop stall is detected;
        i.e. when a script is running for too long.  Only supported on Linux.

  cpu-stop ID [NAME]      Stop CPU profiling on worker ID.
        The profile is saved as `<NAME>.cpuprofile`. CPU profiles must be
        loaded into Chrome Dev Tools. The NAME is optional, and defaults to
        `node.<PID>`.

  heap-snapshot ID [NAME] Save heap snapshot for worker ID.
        The snapshot is saved as `<NAME>.heapsnapshot`.  Heap snapshots must be
        loaded into Chrome Dev Tools. The NAME is optional, and defaults to
        `node.<PID>`.

  patch ID FILE           Apply patch FILE to worker ID.

  ls ID [DEPTH]           List dependencies of the service ID.

  env[-get] SRV_ID [KEYS...]
        List specified environment variables for service SRV_ID. If none are
        specified, list all variables.
  env-set SRV_ID K=V...   Set one or more environment variables for
        service SRV_ID.
  env-unset SRV_ID KEYS...
        Unset one or more environment variables for service SRV_ID. The
        environment variables are applied to the current application, and the
        application is hard restarted with the new environment after change
        (either set or unset).

  log-dump SRV_ID [--follow]
        Empty the log buffer, dumping the contents to stdout for service SRV_ID.
        If --follow is given the log buffer is continuously dumped to stdout.

`SRV_ID` is either ID or Name of a service. It can be obtained by listing
services using `service-list` or looking up service status with `status`.

Worker `ID` can be obtained using the `status` command and refers to a specific
worker of a service.
